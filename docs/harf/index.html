
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for the حرف API"
        >
    <title>API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #303030;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sa {
  color: #aa759f;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-2e7943e3.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-9801298e.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-78ea9ead.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;java&quot;,&quot;plaintext&quot;,&quot;python&quot;,&quot;php&quot;,&quot;csharp&quot;]">
  <div style="position:fixed;z-index:50;height:4px;width:100%;background-color:#FF6200;">
  </div>
    <a href="#" id="nav-button">
      <span>
      منو 
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-639416b0.svg" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">CURL</a>
              <a href="#" data-language-name="java">JAVA</a>
              <a href="#" data-language-name="plaintext">RAW</a>
              <a href="#" data-language-name="python">PYTHON</a>
              <a href="#" data-language-name="php">PHP</a>
              <a href="#" data-language-name="csharp">C#</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="جست و جو">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#92f5faa2a5" class="toc-h1 toc-link" data-title="حرف">حرف</a>
          </li>
          <li>
            <a href="#5d482596b5" class="toc-h1 toc-link" data-title="تبدیل صدا به متن به‌شکل همگام">تبدیل صدا به متن به‌شکل همگام</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#597eba20f8" class="toc-h2 toc-link" data-title="مثال: ارسال لینک فایل">مثال: ارسال لینک فایل</a>
                  </li>
                  <li>
                    <a href="#906dea192d" class="toc-h2 toc-link" data-title="مثال: ارسال مستقیم فایل">مثال: ارسال مستقیم فایل</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#c98b276ded" class="toc-h1 toc-link" data-title="تبدیل صدا به متن به‌شکل ناهمگام">تبدیل صدا به متن به‌شکل ناهمگام</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#75a10c62a4" class="toc-h2 toc-link" data-title="مثال: ارسال لینک فایل به‌شکل ناهمگام">مثال: ارسال لینک فایل به‌شکل ناهمگام</a>
                  </li>
                  <li>
                    <a href="#31cb2ae61f" class="toc-h2 toc-link" data-title="مثال: دریافت پاسخ به‌شکل ناهمگام">مثال: دریافت پاسخ به‌شکل ناهمگام</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#3b1dd46314" class="toc-h1 toc-link" data-title="تبدیل پخش زندهٔ صدا به متن">تبدیل پخش زندهٔ صدا به متن</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#b40d4b44b2" class="toc-h2 toc-link" data-title="مثال">مثال</a>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='92f5faa2a5'>حرف</h1>
<p>حرف، یک ای‌پی‌آیِ تبدیل گفتار به نوشتار فارسی است که می‌تواند صدای ورودی را اعم از صوت یا ویدیو یا پخش زنده به متن تبدیل کند. حرف با شنیدن هزاران ساعت گفتارِ فارسی در انواع و اقسام لحن‌ها، رده‌های سنی و جنسیت‌های مختلف، به‌خوبی تعلیم دیده است و با دقت بالایی این کار را انجام می‌دهد.</p>

<p>برای دسترسی به این ای‌پی‌آی، به یک <code>TOKEN_KEY</code> نیاز دارید که می‌توانید از طریق ایمیلِ harf@roshan-ai.ir درخواست دهید.</p>
<h1 id='5d482596b5'>تبدیل صدا به متن به‌شکل همگام</h1>
<p>این تابع، فایل‌های صوتی یا ویدیویی را دریافت می‌کند و متن هر فایل را به‌شکل JSON تحویل می‌دهد. در خروجی، آدرس هر فایل (<code>media_url</code>) به‌همراه مدت‌زمان فایل (<code>duration</code>) و سگمنت‌ها (<code>segments</code>) بازگردانده می‌شود. هر سگمنت، بازهٔ زمانی کوتاهی شامل سه پارامتر <code>start</code> و <code>end</code> و <code>text</code> است که به‌ترتیب بیانگر شروع بازه، پایان بازه و متن بازه است.</p>
<h2 id='597eba20f8'>مثال: ارسال لینک فایل</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ]
}
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">--request</span> POST <span class="se">\ </span>
      <span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span> <span class="se">\</span>
      <span class="nt">--data-binary</span> <span class="o">{</span>
    <span class="s2">"media_urls"</span>: <span class="o">[</span>
        <span class="s2">"https://i.ganjoor.net/a2/41417.mp3"</span>
    <span class="o">]</span>
<span class="o">}</span> <span class="se">\</span>
      http://harf.roshan-ai.ir/api/transcribe_files/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span>

<span class="n">values</span> <span class="o">=</span> <span class="s">"""
{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ]
}
"""</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">'http://harf.roshan-ai.ir/api/transcribe_files/'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="n">response_body</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">response_body</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">java.lang.System</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MyRequest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="s">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="o">);</span>
            <span class="nc">URLConnection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="nc">HttpURLConnection</span> <span class="n">http</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span><span class="n">con</span><span class="o">;</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"POST"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">byte</span><span class="o">[]</span> <span class="n">out</span> <span class="o">=</span> <span class="s">"{
    "</span><span class="n">media_urls</span><span class="s">": [
        "</span><span class="nl">https:</span><span class="c1">//i.ganjoor.net/a2/41417.mp3"</span>
    <span class="o">]</span>
<span class="o">}</span><span class="s">".getBytes(StandardCharsets.UTF_8);
            int length = out.length;

            http.setFixedLengthStreamingMode(length);
            http.setRequestProperty("</span><span class="nc">Content</span><span class="o">-</span><span class="nc">Type</span><span class="s">", "</span><span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="s">");
            http.setRequestProperty("</span><span class="nc">Authorization</span><span class="s">", "</span><span class="nc">Token</span> <span class="no">TOKEN_KEY</span><span class="err">"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
            <span class="k">try</span><span class="o">(</span><span class="nc">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">os</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nc">BufferedReader</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">http</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
            <span class="nc">String</span> <span class="n">inputLine</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">inputLine</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">inputLine</span><span class="o">);</span>
            <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>

  <span class="nv">$url</span> <span class="o">=</span> <span class="s2">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="p">;</span>
  <span class="nv">$content</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span>
      <span class="s1">'{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ]
}'</span><span class="p">);</span>
  <span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HTTPHEADER</span><span class="p">,</span>
          <span class="k">array</span><span class="p">(</span>
              <span class="s2">"Content-Type: application/json"</span><span class="p">,</span>
              <span class="s2">"Authorization: Token TOKEN_KEY"</span><span class="p">,</span>
              <span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$content</span><span class="p">);</span>

  <span class="nv">$json_response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

  <span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLINFO_HTTP_CODE</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span> <span class="nv">$status</span> <span class="o">!=</span> <span class="mi">200</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">die</span><span class="p">(</span><span class="s2">"Error: call to URL </span><span class="nv">$url</span><span class="s2"> failed with status </span><span class="nv">$status</span><span class="s2">, response </span><span class="nv">$json_response</span><span class="s2">, curl_error "</span> <span class="mf">.</span> <span class="nb">curl_error</span><span class="p">(</span><span class="nv">$curl</span><span class="p">)</span> <span class="mf">.</span> <span class="s2">", curl_errno "</span> <span class="mf">.</span> <span class="nb">curl_errno</span><span class="p">(</span><span class="nv">$curl</span><span class="p">));</span>
  <span class="p">}</span>


  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json_response</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyRequest</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">httpWebRequest</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="p">);</span>
            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"Content-Type"</span><span class="p">]=</span> <span class="s">"application/json"</span><span class="p">;</span>
            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"Authorization"</span><span class="p">]=</span> <span class="s">"Token TOKEN_KEY"</span><span class="p">;</span>

            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">httpWebRequest</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="s">"{
</span>    <span class="s">"media_urls"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">"https://i.ganjoor.net/a2/41417.mp3"</span>
    <span class="p">]</span>
<span class="p">}</span><span class="s">";
</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">httpResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">httpWebRequest</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">streamReader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">httpResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">streamReader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"media_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://i.ganjoor.net/a2/41417.mp3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:44"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"segments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:00"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"حکایت"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"یکی را از حکما شنیدم که می گفت"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"هرگز کسی به جهل خویش اقرار نکرده است"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"مگر آن کس که چون دیگری در سخن باشد"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:21"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"همچنان ناتمام گفته سخن آغاز کند"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="err">...</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre></div>
<p><code>POST /api/transcribe_files/</code></p>

<dl>
<strong>media_urls(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    List of URLs
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  لینک فایل‌های ورودی (صدا یا ویدیو)</p>

<p><br><br></p>
<h2 id='906dea192d'>مثال: ارسال مستقیم فایل</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>"--{boundary value}\nContent-Disposition: form-data; name='document'; filename='FILE NAME'\nContent-Type: text/plain (according to the type of the uploaded file)\n\n{file content}\n--{boundary value}\n"
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">-X</span>
      POST <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span>
      <span class="nt">-F</span> <span class="s2">"document=@example.pdf"</span>
      http://alefba.roshan-ai.ir/api/read_document
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,}</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s">'document'</span><span class="p">:</span> <span class="p">(</span><span class="s">'FILE NAME'</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s">'YOUR FILE PATH'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)),}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="s">'https://alefba.roshan-ai.ir/api/read_document/'</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MultiPartRequest</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>

    <span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://alefba.roshan-ai.ir/api/read_document/"</span><span class="o">;</span>
    <span class="nc">File</span> <span class="n">textFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"YOUR FILE PATH"</span><span class="o">);</span>
    <span class="nc">String</span> <span class="n">boundary</span> <span class="o">=</span> <span class="nc">Long</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
    <span class="nc">String</span> <span class="no">CRLF</span> <span class="o">=</span> <span class="s">"\r\n"</span><span class="o">;</span>

    <span class="nc">URLConnection</span> <span class="n">connection</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="n">url</span><span class="o">).</span><span class="na">openConnection</span><span class="o">();</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"accept"</span><span class="o">,</span> <span class="s">"*/*"</span><span class="o">);</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Connection"</span><span class="o">,</span> <span class="s">"close"</span><span class="o">);</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Token TOKEN_KEY"</span><span class="o">);</span>
    <span class="n">connection</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"multipart/form-data; boundary="</span> <span class="o">+</span> <span class="n">boundary</span><span class="o">);</span>

    <span class="k">try</span> <span class="o">(</span>
        <span class="nc">OutputStream</span> <span class="n">output</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
        <span class="nc">PrintWriter</span> <span class="n">writer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PrintWriter</span><span class="o">(</span><span class="k">new</span> <span class="nc">OutputStreamWriter</span><span class="o">(</span><span class="n">output</span><span class="o">),</span> <span class="kc">true</span><span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"--"</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">boundary</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="no">CRLF</span><span class="o">);</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Content-Disposition: form-data; name=\"document\"; filename=\""</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">textFile</span><span class="o">.</span><span class="na">getName</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">"\""</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="no">CRLF</span><span class="o">);</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"Content-Type: application/pdf"</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="no">CRLF</span><span class="o">);</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="no">CRLF</span><span class="o">).</span><span class="na">flush</span><span class="o">();</span>
      <span class="nc">Files</span><span class="o">.</span><span class="na">copy</span><span class="o">(</span><span class="n">textFile</span><span class="o">.</span><span class="na">toPath</span><span class="o">(),</span> <span class="n">output</span><span class="o">);</span>
      <span class="n">output</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="no">CRLF</span><span class="o">).</span><span class="na">flush</span><span class="o">();</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"--"</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">boundary</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">"--"</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="no">CRLF</span><span class="o">).</span><span class="na">flush</span><span class="o">();</span>
    <span class="o">}</span>


    <span class="nc">BufferedReader</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">((</span><span class="nc">InputStream</span><span class="o">)</span> <span class="n">connection</span><span class="o">.</span><span class="na">getContent</span><span class="o">()));</span>
    <span class="nc">String</span> <span class="n">inputLine</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">((</span><span class="n">inputLine</span> <span class="o">=</span> <span class="n">inputStream</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">inputLine</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">inputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="nv">$fields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"f1"</span><span class="o">=&gt;</span><span class="s2">"value1"</span><span class="p">,</span> <span class="s2">"another_field2"</span><span class="o">=&gt;</span><span class="s2">"anothervalue"</span><span class="p">);</span>

<span class="nv">$filenames</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"FILE_PATH_1"</span><span class="p">,</span> <span class="s2">"FILE_PATH_2"</span><span class="p">);</span>

<span class="nv">$files</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$filenames</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">){</span>
   <span class="nv">$files</span><span class="p">[</span><span class="nv">$f</span><span class="p">]</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="p">}</span>

<span class="nv">$url</span> <span class="o">=</span> <span class="s2">"https://alefba.roshan-ai.ir/api/read_document/"</span><span class="p">;</span>

<span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>

<span class="nv">$url_data</span> <span class="o">=</span> <span class="nb">http_build_query</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="nv">$boundary</span> <span class="o">=</span> <span class="nb">uniqid</span><span class="p">();</span>
<span class="nv">$delimiter</span> <span class="o">=</span> <span class="s1">'-------------'</span> <span class="mf">.</span> <span class="nv">$boundary</span><span class="p">;</span>

<span class="nv">$post_data</span> <span class="o">=</span> <span class="nf">build_data_files</span><span class="p">(</span><span class="nv">$boundary</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">,</span> <span class="nv">$files</span><span class="p">);</span>

<span class="nb">curl_setopt_array</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
  <span class="no">CURLOPT_URL</span> <span class="o">=&gt;</span> <span class="nv">$url</span><span class="p">,</span>
  <span class="no">CURLOPT_RETURNTRANSFER</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
  <span class="no">CURLOPT_MAXREDIRS</span> <span class="o">=&gt;</span> <span class="mi">10</span><span class="p">,</span>
  <span class="no">CURLOPT_TIMEOUT</span> <span class="o">=&gt;</span> <span class="mi">30</span><span class="p">,</span>
  <span class="no">CURLOPT_HTTP_VERSION</span> <span class="o">=&gt;</span> <span class="no">CURL_HTTP_VERSION_1_1</span><span class="p">,</span>
  <span class="no">CURLOPT_CUSTOMREQUEST</span> <span class="o">=&gt;</span> <span class="s2">"POST"</span><span class="p">,</span>
  <span class="no">CURLOPT_POST</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
  <span class="no">CURLOPT_POSTFIELDS</span> <span class="o">=&gt;</span> <span class="nv">$post_data</span><span class="p">,</span>
  <span class="no">CURLOPT_HTTPHEADER</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">"Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"Content-Type: multipart/form-data; boundary="</span> <span class="mf">.</span> <span class="nv">$delimiter</span><span class="p">,</span>
  <span class="p">),</span>
<span class="p">));</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

<span class="nv">$info</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>
<span class="nv">$err</span> <span class="o">=</span> <span class="nb">curl_error</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">"error"</span><span class="p">;</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$err</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

<span class="k">function</span> <span class="n">build_data_files</span><span class="p">(</span><span class="nv">$boundary</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">,</span> <span class="nv">$files</span><span class="p">){</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nv">$eol</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">;</span>
    <span class="nv">$delimiter</span> <span class="o">=</span> <span class="s1">'-------------'</span> <span class="mf">.</span> <span class="nv">$boundary</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$fields</span> <span class="k">as</span> <span class="nv">$name</span> <span class="o">=&gt;</span> <span class="nv">$content</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$data</span> <span class="mf">.</span><span class="o">=</span> <span class="s2">"--"</span> <span class="mf">.</span> <span class="nv">$delimiter</span> <span class="mf">.</span> <span class="nv">$eol</span>
            <span class="mf">.</span> <span class="s1">'Content-Disposition: form-data; name="'</span> <span class="mf">.</span> <span class="nv">$name</span> <span class="mf">.</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="mf">.</span><span class="nv">$eol</span><span class="mf">.</span><span class="nv">$eol</span>
            <span class="mf">.</span> <span class="nv">$content</span> <span class="mf">.</span> <span class="nv">$eol</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$name</span> <span class="o">=&gt;</span> <span class="nv">$content</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$data</span> <span class="mf">.</span><span class="o">=</span> <span class="s2">"--"</span> <span class="mf">.</span> <span class="nv">$delimiter</span> <span class="mf">.</span> <span class="nv">$eol</span>
            <span class="mf">.</span> <span class="s1">'Content-Disposition: form-data; name="'</span> <span class="mf">.</span> <span class="nv">$name</span> <span class="mf">.</span> <span class="s1">'"; filename="'</span> <span class="mf">.</span> <span class="nv">$name</span> <span class="mf">.</span> <span class="s1">'"'</span> <span class="mf">.</span> <span class="nv">$eol</span>
            <span class="mf">.</span> <span class="s1">'Content-Type: image/png'</span><span class="mf">.</span><span class="nv">$eol</span>
            <span class="mf">.</span> <span class="s1">'Content-Transfer-Encoding: binary'</span><span class="mf">.</span><span class="nv">$eol</span>
            <span class="p">;</span>
        <span class="nv">$data</span> <span class="mf">.</span><span class="o">=</span> <span class="nv">$eol</span><span class="p">;</span>
        <span class="nv">$data</span> <span class="mf">.</span><span class="o">=</span> <span class="nv">$content</span> <span class="mf">.</span> <span class="nv">$eol</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$data</span> <span class="mf">.</span><span class="o">=</span> <span class="s2">"--"</span> <span class="mf">.</span> <span class="nv">$delimiter</span> <span class="mf">.</span> <span class="s2">"--"</span><span class="mf">.</span><span class="nv">$eol</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http.Headers</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyRequest</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">async</span> <span class="k">void</span> <span class="nf">UploadFile</span><span class="p">(</span><span class="n">String</span> <span class="n">serverAddress</span><span class="p">,</span><span class="n">String</span> <span class="n">filePath</span><span class="p">,</span><span class="n">String</span><span class="p">[]</span> <span class="n">paramsName</span><span class="p">,</span><span class="n">String</span><span class="p">[]</span> <span class="n">paramsValue</span><span class="p">){</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">formData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MultipartFormDataContent</span><span class="p">()){</span>
                <span class="n">formData</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentType</span><span class="p">.</span><span class="n">MediaType</span> <span class="p">=</span> <span class="s">"multipart/form-data"</span><span class="p">;</span>
                <span class="kt">var</span> <span class="n">filestream</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FileStream</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">FileMode</span><span class="p">.</span><span class="n">Open</span><span class="p">);</span>
                <span class="n">Stream</span> <span class="n">fileStream</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="nf">OpenRead</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>
                <span class="kt">var</span> <span class="n">fileName</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Path</span><span class="p">.</span><span class="nf">GetFileName</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>

                <span class="n">formData</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentDisposition</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ContentDispositionHeaderValue</span><span class="p">(</span><span class="s">"attachment"</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">FileName</span> <span class="p">=</span> <span class="n">fileName</span>
                <span class="p">};</span>

                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span><span class="n">i</span><span class="p">&lt;</span><span class="n">paramsName</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="n">i</span><span class="p">++){</span>
                    <span class="kt">var</span> <span class="n">stringContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">paramsValue</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                    <span class="n">stringContent</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Content-Disposition"</span><span class="p">,</span> <span class="s">"form-data; name=\""</span> <span class="p">+</span> <span class="n">paramsName</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">+</span> <span class="s">"\""</span><span class="p">);</span>
                    <span class="n">formData</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">stringContent</span><span class="p">,</span> <span class="n">paramsName</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="p">}</span>

                <span class="n">formData</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">StreamContent</span><span class="p">(</span><span class="n">fileStream</span><span class="p">),</span> <span class="s">"file"</span><span class="p">,</span> <span class="n">filename</span><span class="p">);</span>

                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">()){</span>
                    <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">"Token"</span> <span class="p">+</span> <span class="n">_bearerToken</span><span class="p">);</span>

                    <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">serverAddress</span><span class="p">,</span> <span class="n">formData</span><span class="p">).</span><span class="n">Result</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>

                    <span class="kt">var</span> <span class="n">message</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">serverAddress</span><span class="p">,</span> <span class="n">formData</span><span class="p">);</span>
                    <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">message</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
                    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"media_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://harf.roshan-ai.ir/media/files/96/84/859267728361.mp3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:44"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"segments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:00"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"حکایت"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:02"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"یکی را از حکما شنیدم که می گفت"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:06"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"هرگز کسی به جهل خویش اقرار نکرده است"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:11"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"مگر آن کس که چون دیگری در سخن باشد"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:16"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0:00:21"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"همچنان ناتمام گفته سخن آغاز کند"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="err">...</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre></div>
<p><code>POST /api/transcribe_files/</code></p>

<dl>
<strong>media(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    file in binary
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  فایل ورودی</p>

<p><br><br></p>
<h1 id='c98b276ded'>تبدیل صدا به متن به‌شکل ناهمگام</h1>
<p>در این بخش نحوه تحلیل فایل به صورت ناهمگام، توضیح داده شده است.</p>
<h2 id='75a10c62a4'>مثال: ارسال لینک فایل به‌شکل ناهمگام</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ],
    "wait": false
}
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">--request</span> POST <span class="se">\ </span>
      <span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span> <span class="se">\</span>
      <span class="nt">--data-binary</span> <span class="o">{</span>
    <span class="s2">"media_urls"</span>: <span class="o">[</span>
        <span class="s2">"https://i.ganjoor.net/a2/41417.mp3"</span>
    <span class="o">]</span>,
    <span class="s2">"wait"</span>: <span class="nb">false</span>
<span class="o">}</span> <span class="se">\</span>
      http://harf.roshan-ai.ir/api/transcribe_files/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span>

<span class="n">values</span> <span class="o">=</span> <span class="s">"""
{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ],
    "wait": false
}
"""</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">'http://harf.roshan-ai.ir/api/transcribe_files/'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="n">response_body</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">response_body</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">java.lang.System</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MyRequest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="s">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="o">);</span>
            <span class="nc">URLConnection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="nc">HttpURLConnection</span> <span class="n">http</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span><span class="n">con</span><span class="o">;</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"POST"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">byte</span><span class="o">[]</span> <span class="n">out</span> <span class="o">=</span> <span class="s">"{
    "</span><span class="n">media_urls</span><span class="s">": [
        "</span><span class="nl">https:</span><span class="c1">//i.ganjoor.net/a2/41417.mp3"</span>
    <span class="o">],</span>
    <span class="s">"wait"</span><span class="o">:</span> <span class="kc">false</span>
<span class="o">}</span><span class="s">".getBytes(StandardCharsets.UTF_8);
            int length = out.length;

            http.setFixedLengthStreamingMode(length);
            http.setRequestProperty("</span><span class="nc">Content</span><span class="o">-</span><span class="nc">Type</span><span class="s">", "</span><span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="s">");
            http.setRequestProperty("</span><span class="nc">Authorization</span><span class="s">", "</span><span class="nc">Token</span> <span class="no">TOKEN_KEY</span><span class="err">"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
            <span class="k">try</span><span class="o">(</span><span class="nc">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">os</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nc">BufferedReader</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">http</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
            <span class="nc">String</span> <span class="n">inputLine</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">inputLine</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">inputLine</span><span class="o">);</span>
            <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>

  <span class="nv">$url</span> <span class="o">=</span> <span class="s2">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="p">;</span>
  <span class="nv">$content</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span>
      <span class="s1">'{
    "media_urls": [
        "https://i.ganjoor.net/a2/41417.mp3"
    ],
    "wait": false
}'</span><span class="p">);</span>
  <span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HTTPHEADER</span><span class="p">,</span>
          <span class="k">array</span><span class="p">(</span>
              <span class="s2">"Content-Type: application/json"</span><span class="p">,</span>
              <span class="s2">"Authorization: Token TOKEN_KEY"</span><span class="p">,</span>
              <span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$content</span><span class="p">);</span>

  <span class="nv">$json_response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

  <span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLINFO_HTTP_CODE</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span> <span class="nv">$status</span> <span class="o">!=</span> <span class="mi">200</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">die</span><span class="p">(</span><span class="s2">"Error: call to URL </span><span class="nv">$url</span><span class="s2"> failed with status </span><span class="nv">$status</span><span class="s2">, response </span><span class="nv">$json_response</span><span class="s2">, curl_error "</span> <span class="mf">.</span> <span class="nb">curl_error</span><span class="p">(</span><span class="nv">$curl</span><span class="p">)</span> <span class="mf">.</span> <span class="s2">", curl_errno "</span> <span class="mf">.</span> <span class="nb">curl_errno</span><span class="p">(</span><span class="nv">$curl</span><span class="p">));</span>
  <span class="p">}</span>


  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json_response</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyRequest</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">httpWebRequest</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="p">);</span>
            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"Content-Type"</span><span class="p">]=</span> <span class="s">"application/json"</span><span class="p">;</span>
            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"Authorization"</span><span class="p">]=</span> <span class="s">"Token TOKEN_KEY"</span><span class="p">;</span>

            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">httpWebRequest</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="s">"{
</span>    <span class="s">"media_urls"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">"https://i.ganjoor.net/a2/41417.mp3"</span>
    <span class="p">],</span>
    <span class="s">"wait"</span><span class="p">:</span> <span class="k">false</span>
<span class="p">}</span><span class="s">";
</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">httpResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">httpWebRequest</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">streamReader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">httpResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">streamReader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"state"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"task_ids"</span><span class="p">:[</span><span class="s2">"..."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p>اگر در درخواست خود مقدار پارامتر <code>wait</code> را برابر <code>false</code> قرار دهید، درخواست به‌شکل ناهمگام ارسال می‌شود. در این حالت دیگر لازم نیست منتظر نتیجه بمانید. درعوض، در خروجی، دو پارامتر <code>state</code> و <code>task_ids</code> دریافت می‌کنید که اولی وضعیت پردازش را مشخص می‌کند و دومی لیستی از <code>task_id</code> ها را برمی‌گرداند.  هر <code>task_id</code> شناسهٔ پردازش یک فایل است که بعداً می‌توانید با تابع «دریافت پاسخ به‌شکل ناهمگام» از وضعیت پردازش آن باخبر شوید. در درخواست به‌شکل ناهمگام اگر نتیجهٔ پردازش آماده باشد، بلافاصله در خروجی نمایش داده می‌شود، اگر نه، وضعیت پردازش در پارامتر <code>state</code> برگردانده می‌شود، مثلاً <code>PENDING</code> یعنی در حال پردازش است.</p>

<p><code>POST /api/transcribe_files/</code></p>

<dl>
<strong>media_urls(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    List of URLs
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  لینک فایل‌های ورودی</p>

<p><br><br>
<dl>
<strong>wait</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    true
                    </span>
</dl></p>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  اگر <code>false</code> باشد یعنی منتظر نتیجه نمی‌ماند. درعوض شناسهٔ پردازش فایل‌ها (<code>task_ids</code>) را برمی‌گرداند تا خودتان هرازگاهی وضعیت پردازش را چک کنید و بعد از پایان پردازش، مجددا درخواست دهید و خروجی نهایی را ببینید.</p>

<p><br><br></p>
<h2 id='31cb2ae61f'>مثال: دریافت پاسخ به‌شکل ناهمگام</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>{
    "tasks_ids": [
        "..."
    ],
    "wait": false
}
</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>curl  <span class="nt">--request</span> POST <span class="se">\ </span>
      <span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">--header</span> <span class="s2">"Authorization: Token TOKEN_KEY"</span> <span class="se">\</span>
      <span class="nt">--data-binary</span> <span class="o">{</span>
    <span class="s2">"tasks_ids"</span>: <span class="o">[</span>
        <span class="s2">"..."</span>
    <span class="o">]</span>,
    <span class="s2">"wait"</span>: <span class="nb">false</span>
<span class="o">}</span> <span class="se">\</span>
      http://harf.roshan-ai.ir/api/transcribe_files/
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">urlopen</span>

<span class="n">values</span> <span class="o">=</span> <span class="s">"""
{
    "tasks_ids": [
        "..."
    ],
    "wait": false
}
"""</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Token TOKEN_KEY'</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="s">'http://harf.roshan-ai.ir/api/transcribe_files/'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="n">response_body</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">response_body</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="kn">import</span> <span class="nn">java.lang.System</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.BufferedReader</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">MyRequest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">){</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="s">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="o">);</span>
            <span class="nc">URLConnection</span> <span class="n">con</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
            <span class="nc">HttpURLConnection</span> <span class="n">http</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpURLConnection</span><span class="o">)</span><span class="n">con</span><span class="o">;</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"POST"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

            <span class="kt">byte</span><span class="o">[]</span> <span class="n">out</span> <span class="o">=</span> <span class="s">"{
    "</span><span class="n">tasks_ids</span><span class="s">": [
        "</span><span class="o">...</span><span class="s">"
    ],
    "</span><span class="n">wait</span><span class="s">": false
}"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>

            <span class="n">http</span><span class="o">.</span><span class="na">setFixedLengthStreamingMode</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Token TOKEN_KEY"</span><span class="o">);</span>
            <span class="n">http</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>
            <span class="k">try</span><span class="o">(</span><span class="nc">OutputStream</span> <span class="n">os</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">os</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
            <span class="o">}</span>

            <span class="nc">BufferedReader</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">http</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">()));</span>
            <span class="nc">String</span> <span class="n">inputLine</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">inputLine</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">inputLine</span><span class="o">);</span>
            <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>

  <span class="nv">$url</span> <span class="o">=</span> <span class="s2">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="p">;</span>
  <span class="nv">$content</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span>
      <span class="s1">'{
    "tasks_ids": [
        "..."
    ],
    "wait": false
}'</span><span class="p">);</span>
  <span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HEADER</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_HTTPHEADER</span><span class="p">,</span>
          <span class="k">array</span><span class="p">(</span>
              <span class="s2">"Content-Type: application/json"</span><span class="p">,</span>
              <span class="s2">"Authorization: Token TOKEN_KEY"</span><span class="p">,</span>
              <span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$content</span><span class="p">);</span>

  <span class="nv">$json_response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

  <span class="nv">$status</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="no">CURLINFO_HTTP_CODE</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span> <span class="nv">$status</span> <span class="o">!=</span> <span class="mi">200</span> <span class="p">)</span> <span class="p">{</span>
      <span class="k">die</span><span class="p">(</span><span class="s2">"Error: call to URL </span><span class="nv">$url</span><span class="s2"> failed with status </span><span class="nv">$status</span><span class="s2">, response </span><span class="nv">$json_response</span><span class="s2">, curl_error "</span> <span class="mf">.</span> <span class="nb">curl_error</span><span class="p">(</span><span class="nv">$curl</span><span class="p">)</span> <span class="mf">.</span> <span class="s2">", curl_errno "</span> <span class="mf">.</span> <span class="nb">curl_errno</span><span class="p">(</span><span class="nv">$curl</span><span class="p">));</span>
  <span class="p">}</span>


  <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span>

  <span class="nv">$response</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json_response</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">MyRequest</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">httpWebRequest</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebRequest</span><span class="p">)</span><span class="n">WebRequest</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="s">"http://harf.roshan-ai.ir/api/transcribe_files/"</span><span class="p">);</span>
            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"Content-Type"</span><span class="p">]=</span> <span class="s">"application/json"</span><span class="p">;</span>
            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Headers</span><span class="p">[</span><span class="s">"Authorization"</span><span class="p">]=</span> <span class="s">"Token TOKEN_KEY"</span><span class="p">;</span>

            <span class="n">httpWebRequest</span><span class="p">.</span><span class="n">Method</span> <span class="p">=</span> <span class="s">"POST"</span><span class="p">;</span>

            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">streamWriter</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamWriter</span><span class="p">(</span><span class="n">httpWebRequest</span><span class="p">.</span><span class="nf">GetRequestStream</span><span class="p">()))</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">json</span> <span class="p">=</span> <span class="s">"{
</span>    <span class="s">"tasks_ids"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">"..."</span>
    <span class="p">],</span>
    <span class="s">"wait"</span><span class="p">:</span> <span class="k">false</span>
<span class="p">}</span><span class="s">";
</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Flush</span><span class="p">();</span>
                <span class="n">streamWriter</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">httpResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">HttpWebResponse</span><span class="p">)</span><span class="n">httpWebRequest</span><span class="p">.</span><span class="nf">GetResponse</span><span class="p">();</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">streamReader</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StreamReader</span><span class="p">(</span><span class="n">httpResponse</span><span class="p">.</span><span class="nf">GetResponseStream</span><span class="p">()))</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">streamReader</span><span class="p">.</span><span class="nf">ReadToEnd</span><span class="p">();</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="nl">"state"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p>با ارسال یک یا چند شناسهٔ پردازش در پارامتر <code>task_ids</code>، نتیجهٔ پردازش آن‌ها بازگردانده می‌شود. در پاسخ خروجی، پارامتر <code>state</code> می‌تواند سه حالت داشته باشد. <code>PENDING</code> یعنی در حال پردازش، <code>FAILURE</code> یعنی بروز خطا، <code>TIMEOUT</code> یعنی پردازش فایل بیش از تحمل سامانه بوده است.</p>

<p><code>POST /api/transcribe_files/</code></p>

<dl>
<strong>task_ids(required)</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    List of task ids
                    </span>
</dl>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  لیست شناسه‌های پردازش</p>

<p><br><br>
<dl>
<strong>wait</strong>
<br>
<br>
Value: <span style="background-color: #00A693;
                    border-color: #00A693;
                    border-width: 3px;
                    border-radius: 2px">
                    true
                    </span>
</dl></p>

<p style="direction:rtl;font-weight:300;">
<img src="images/vector-c3fae21d.svg" alt="vector">  همانند قبل.</p>

<p><br><br></p>
<h1 id='3b1dd46314'>تبدیل پخش زندهٔ صدا به متن</h1>
<p>برای تبدیل صدای درحال‌پخش (زنده، لایو، استریم) باید از طریق وب‌سوکت به سامانه متصل شوید. در این حالت، پس از برقراری ارتباط، فایل باید در قالب wav به صورت باینری به سرور ارسال شود.</p>

<p>{&quot;segment_id&quot;: 1, &quot;text&quot;: &quot;سازمان بهداشت جهانی&quot;, &quot;start&quot;: &quot;0:00:00&quot;, &quot;end&quot;: &quot;0:00:05&quot;}</p>

<p>اگر پردازش کامل نشده باشد، پاسخی به‌شکل زیر ارسال می‌شود:</p>

<p>{&quot;state&quot;: &quot;PENDING&quot;}</p>

<p>در انتها، برای اعلام پایان فرایند پردازش باید متن &quot;finalize&quot;به سرور ارسال شود.</p>
<h2 id='b40d4b44b2'>مثال</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>from websocket import create_connection                                              
headers = {'Authorization' : 'Token ...'}
ws = create_connection("wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/", headers=headers)
with open('sample.wav' ,'rb') as f:
    bs=f.read()
window_size = 32000
number_of_window = (len(bs) + 1) // window_size
for i in range(number_of_window):
    ws.send_binary(bs[window_size*i:window_size*(i+1)])
    data = ws.recv()
ws.send("finalize")
data= ws.recv()
ws.close()

</code></pre></div><div class="highlight"><pre class="highlight shell tab-shell"><code>from websocket import create_connection                                              
headers <span class="o">=</span> <span class="o">{</span><span class="s1">'Authorization'</span> : <span class="s1">'Token ...'</span><span class="o">}</span>
ws <span class="o">=</span> create_connection<span class="o">(</span><span class="s2">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span>, <span class="nv">headers</span><span class="o">=</span>headers<span class="o">)</span>
with open<span class="o">(</span><span class="s1">'sample.wav'</span> ,<span class="s1">'rb'</span><span class="o">)</span> as f:
    <span class="nv">bs</span><span class="o">=</span>f.read<span class="o">()</span>
window_size <span class="o">=</span> 32000
number_of_window <span class="o">=</span> <span class="o">(</span>len<span class="o">(</span>bs<span class="o">)</span> + 1<span class="o">)</span> // window_size
<span class="k">for </span>i <span class="k">in </span>range<span class="o">(</span>number_of_window<span class="o">)</span>:
    ws.send_binary<span class="o">(</span>bs[window_size<span class="k">*</span>i:window_size<span class="k">*</span><span class="o">(</span>i+1<span class="o">)])</span>
    data <span class="o">=</span> ws.recv<span class="o">()</span>
ws.send<span class="o">(</span><span class="s2">"finalize"</span><span class="o">)</span>
<span class="nv">data</span><span class="o">=</span> ws.recv<span class="o">()</span>
ws.close<span class="o">()</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">websocket</span> <span class="kn">import</span> <span class="n">create_connection</span>                                              
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span> <span class="p">:</span> <span class="s">'Token ...'</span><span class="p">}</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">(</span><span class="s">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'sample.wav'</span> <span class="p">,</span><span class="s">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">bs</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">window_size</span> <span class="o">=</span> <span class="mi">32000</span>
<span class="n">number_of_window</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">window_size</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_window</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send_binary</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="n">window_size</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="n">window_size</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ws</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="s">"finalize"</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span> <span class="n">ws</span><span class="p">.</span><span class="n">recv</span><span class="p">()</span>
<span class="n">ws</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code><span class="n">from</span> <span class="n">websocket</span> <span class="kn">import</span> <span class="nn">create_connection</span>                                              
<span class="n">headers</span> <span class="o">=</span> <span class="o">{</span><span class="err">'</span><span class="nc">Authorization</span><span class="err">'</span> <span class="o">:</span> <span class="err">'</span><span class="nc">Token</span> <span class="o">...</span><span class="err">'</span><span class="o">}</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">create_connection</span><span class="o">(</span><span class="s">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span><span class="o">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="o">)</span>
<span class="n">with</span> <span class="nf">open</span><span class="o">(</span><span class="err">'</span><span class="n">sample</span><span class="o">.</span><span class="na">wav</span><span class="err">'</span> <span class="o">,</span><span class="err">'</span><span class="n">rb</span><span class="err">'</span><span class="o">)</span> <span class="n">as</span> <span class="nl">f:</span>
    <span class="n">bs</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="na">read</span><span class="o">()</span>
<span class="n">window_size</span> <span class="o">=</span> <span class="mi">32000</span>
<span class="n">number_of_window</span> <span class="o">=</span> <span class="o">(</span><span class="n">len</span><span class="o">(</span><span class="n">bs</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="c1">// window_size</span>
<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="nf">range</span><span class="o">(</span><span class="n">number_of_window</span><span class="o">):</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">send_binary</span><span class="o">(</span><span class="n">bs</span><span class="o">[</span><span class="n">window_size</span><span class="o">*</span><span class="nl">i:</span><span class="n">window_size</span><span class="o">*(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">)])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="na">recv</span><span class="o">()</span>
<span class="n">ws</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="s">"finalize"</span><span class="o">)</span>
<span class="n">data</span><span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="na">recv</span><span class="o">()</span>
<span class="n">ws</span><span class="o">.</span><span class="na">close</span><span class="o">()</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="n">from</span> <span class="n">websocket</span> <span class="n">import</span> <span class="n">create_connection</span>                                              
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'Authorization'</span> <span class="o">:</span> <span class="s1">'Token ...'</span><span class="p">}</span>
<span class="n">ws</span> <span class="o">=</span> <span class="nf">create_connection</span><span class="p">(</span><span class="s2">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">with</span> <span class="nf">open</span><span class="p">(</span><span class="s1">'sample.wav'</span> <span class="p">,</span><span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="o">:</span>
    <span class="n">bs</span><span class="o">=</span><span class="n">f</span><span class="mf">.</span><span class="nf">read</span><span class="p">()</span>
<span class="n">window_size</span> <span class="o">=</span> <span class="mi">32000</span>
<span class="n">number_of_window</span> <span class="o">=</span> <span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// window_size</span>
<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_window</span><span class="p">)</span><span class="o">:</span>
    <span class="n">ws</span><span class="mf">.</span><span class="nf">send_binary</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="n">window_size</span><span class="o">*</span><span class="n">i</span><span class="o">:</span><span class="n">window_size</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">ws</span><span class="mf">.</span><span class="nf">recv</span><span class="p">()</span>
<span class="n">ws</span><span class="mf">.</span><span class="nf">send</span><span class="p">(</span><span class="s2">"finalize"</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span> <span class="n">ws</span><span class="mf">.</span><span class="nf">recv</span><span class="p">()</span>
<span class="n">ws</span><span class="mf">.</span><span class="nf">close</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">from</span> <span class="n">websocket</span> <span class="n">import</span> <span class="n">create_connection</span>                                              
<span class="n">headers</span> <span class="p">=</span> <span class="p">{</span><span class="err">'</span><span class="n">Authorization</span><span class="err">'</span> <span class="p">:</span> <span class="err">'</span><span class="n">Token</span> <span class="p">...</span><span class="err">'</span><span class="p">}</span>
<span class="n">ws</span> <span class="p">=</span> <span class="nf">create_connection</span><span class="p">(</span><span class="s">"wss://harf.roshan-ai.ir/ws_api/transcribe_files/wav/sync/"</span><span class="p">,</span> <span class="n">headers</span><span class="p">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">with</span> <span class="nf">open</span><span class="p">(</span><span class="err">'</span><span class="n">sample</span><span class="p">.</span><span class="n">wav</span><span class="err">'</span> <span class="p">,</span><span class="err">'</span><span class="n">rb</span><span class="err">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">bs</span><span class="p">=</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
<span class="n">window_size</span> <span class="p">=</span> <span class="m">32000</span>
<span class="n">number_of_window</span> <span class="p">=</span> <span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span> <span class="c1">// window_size</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">number_of_window</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">send_binary</span><span class="p">(</span><span class="n">bs</span><span class="p">[</span><span class="n">window_size</span><span class="p">*</span><span class="n">i</span><span class="p">:</span><span class="n">window_size</span><span class="p">*(</span><span class="n">i</span><span class="p">+</span><span class="m">1</span><span class="p">)])</span>
    <span class="n">data</span> <span class="p">=</span> <span class="n">ws</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
<span class="n">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="s">"finalize"</span><span class="p">)</span>
<span class="n">data</span><span class="p">=</span> <span class="n">ws</span><span class="p">.</span><span class="nf">recv</span><span class="p">()</span>
<span class="n">ws</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

</code></pre></div>
<blockquote>
<p>Response </p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="nl">"state"</span><span class="p">:</span><span class="s2">"PENDING"</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<p><code>POST /ws_api/transcribe_files/wav/sync/</code></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">CURL</a>
                <a href="#" data-language-name="java">JAVA</a>
                <a href="#" data-language-name="plaintext">RAW</a>
                <a href="#" data-language-name="python">PYTHON</a>
                <a href="#" data-language-name="php">PHP</a>
                <a href="#" data-language-name="csharp">C#</a>
          </div>
      </div>
    </div>
  </body>
</html>

<script>
function Scroll(delay) {
    this.initialY = scrollY;
    this.callbacks = {
        start  : null,
        scroll : null,
        end    : null,
    };
    this.timeout = {
        delay  : delay || 150,
        handle : null,
    };
    this.handler = Scroll.handler.bind(this);
    window.addEventListener("scroll", this.handler);
}

Scroll.handler = function (e) {
    if (this.initialY == 0) {
        if (this.timeout.handle == null) {
            if (this.callbacks.start) {
                this.callbacks.start.call(this, e);
            }
        }
        if (this.timeout.handle !== null) {
            clearTimeout(this.timeout.handle);
        }
        if (this.callbacks.scroll) {
            this.callbacks.scroll.call(this, e);
        }
        var self = this;
        this.timeout.handle = setTimeout(function () {
            self.timeout.handle = null;
            if (self.callbacks.end) {
                self.callbacks.end.call(self, e);
            }
        }, this.timeout.delay);
    } else {
        this.initialY = 0;
    }
};

Scroll.prototype.addEventListener = function (event, callback) {
    if (Object.keys(this.callbacks).includes(event)) {
        this.callbacks[event] = callback;
    } else {
        console.warn("Invalid scroll event: " + event);
    }
};

window.addEventListener('DOMContentLoaded',() => {

    let tocs = document.getElementsByClassName('toc-h1 toc-link active');

    let littleTOCs = document.getElementsByClassName("toc-h2 toc-link active");

    var sl = new Scroll(400);
    
    sl.addEventListener("start", function (e) {

        for(let i = 0; i < tocs.length; i++) {
            tocs[i].style.backgroundColor = 'transparent'
            tocs[i].style.color = 'black'
        }

        for(let i = 0; i < littleTOCs.length; i++) {
            littleTOCs[i].style.backgroundColor = 'transparent'
            littleTOCs[i].style.color = 'black'
        }

    });
    
    sl.addEventListener("scroll", function () {

        for(let i = 0; i < tocs.length; i++) {
            tocs[i].style.backgroundColor = 'transparent'
            tocs[i].style.color = 'black'
        }

        for(let i = 0; i < littleTOCs.length; i++) {
            littleTOCs[i].style.backgroundColor = 'transparent'
            littleTOCs[i].style.color = 'black'
        }
    });
    

    sl.addEventListener("end", function () {

        for(let i = 0; i < tocs.length; i++) {
            tocs[i].style.backgroundColor = '#FF6200'
            tocs[i].style.color = 'white'
        }

        for(let i = 0; i < littleTOCs.length; i++) {
            littleTOCs[i].style.backgroundColor = '#FF6200'
            littleTOCs[i].style.color = 'white'
        }
    });
});
</script>